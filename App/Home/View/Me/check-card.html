<!DOCTYPE html>
<html>

	<head>
		<meta charset="UTF-8">
		<meta http-equiv="X-UA-Compatible" content="IE=edge">
		<meta name="viewport" content="width=device-width, initial-scale=1,maximum-scale=1.0, user-scalable=0,user-scalable=no">
		<meta name="format-detection" content="telephone=no">
		<meta name="renderer" content="webkit">
		<meta http-equiv="Cache-Control" content="no-siteapp" />

		<link rel="stylesheet" href="__PUBLIC__/Home/saibangzi/plugins/boostrap/css/bootstrap.min.css" />
		<link rel="shortcut icon" href="__PUBLIC__/Home/saibangzi/img/favicon.ico" type="image/x-icon"/>
		<link rel="stylesheet" href="__PUBLIC__/Home/saibangzi/plugins/icon-font/iconfont.css" />
		<link rel="stylesheet" href="__PUBLIC__/Home/saibangzi/css/public.css" />
		<link rel="stylesheet" href="__PUBLIC__/Home/saibangzi/css/index.css" />
		<link rel="stylesheet" href="__PUBLIC__/Home/saibangzi/css/per-data/per-data.css" />
		<link rel="stylesheet" href="__PUBLIC__/Home/saibangzi/plugins/csld/css/layout.css" />
		<title>绑定银行卡</title>
<style>
.fenye{
	height:30px;
	margin-top:20px;
	margin-left:30%;

}
#btnSendCode{
	background: #f39232;
    color: white;
    font-size: 14px;
    line-height: 28px;
    width: 110px;
    text-align: center;
    vertical-align: middle;
    display: inline-block;
    border-radius: 6px;
    border: 1px solid #f39232;
}

.fenye div{
	margin-left:30%;
}
.fenye span{
	color: #fff;
	background-color: #00d3d4;
	border:1px solid #00d3d4;
	padding:5px 10px;
}
.fenye a{
	color:#bbb;
	padding:5px 10px;
}
.fenye a:hover{
	color: #fff;
	background-color: #00d3d4;
}
	.sign-out{
		    background: #ccc;
		    color: white;
		    font-size: 18px;
		    line-height: 36px;
		    width: 100px;
		    height: 36px;
		    text-align: center;
		    vertical-align: middle;
		    display: inline-block;
		    border-radius: 6px;
		}
		
		.sign-out span{
			font-size: 16px;
			color: #FFFFFF;
		}
</style>
	</head>

	<body class="bg-f8">
		<!--导航开始-->
		<include file="Public/naodai" />
		<!--导航结束-->

		<div class="container-fluid">
			<div class="row">
				<div class="perd-t">
					<div class="container position_rel">
						<div class="row">
							<div class="img-bg"></div>
							<img src="__ROOT__{$user.image}" class="img-p" />
							<div class="inform">
								<div class="name">
									<span>{$name} </span>
									<i class="iconfont" id="sexicon">&#xe76e;</i>
								<input type="hidden" value="{$user.sex}" id="sex">	
								</div>
								<div class="autograph" style="width:300px;overflow:hidden;text-overflow:ellipsis;white-space:nowrap;">
									<span>{$user.profile}</span>
								</div>
								<if condition="$sign_status eq 1">
								<a class="sign-out">
									<span>已签到</span>
								</a>
								<else />
								<a class="sign-up" onclick="sign()">
									<span>签到</span>
								</a>
								</if>
							</div>
							<div class="integral">
								<p>{$user.integral}</p>
								<span>&nbsp;积分</span>
							</div>
						</div>
					</div>

				</div>
			</div>
		</div>

		<div class="container margin_t50">

				<div class="col-md-3-a bg-white">
					<ul class="u-nav" id="user_menu">
						<li class="item" id="user_menu_my" name="user_menu_my">
							<ul class="sub">
								<li>
									<i class="iconfont ">&#xe638;</i>
									<a href="{:U('Me/index')}">个人资料</a>
									<i class="iconfont ">&#xe607;</i>
								</li>
								<li>
									<i class="iconfont"> &#xe601;</i>
									<a href="{:U('Me/subscribe')}">我的收藏</a>
									<i class="iconfont">&#xe607;</i>
								</li>

								<li>
									<i class="iconfont"> &#xe615;</i>
									<a href="{:U('Me/course')}">我的课程</a>
									<i class="iconfont">&#xe607;</i>
								</li>
								<li>
									<i class="iconfont current"> &#xe6e5;</i>
									<a href="{:U('Me/account')}"  class="current">我的账户</a>
									<i class="iconfont current">&#xe607;</i>
								</li>
								<li>
									<i class="iconfont"> &#xe639;</i>
									<a href="{:U('Me/order')}">订单管理</a>
									<i class="iconfont">&#xe607;</i>
								</li>
								<li style="border-bottom: none;">
									<i class="iconfont"> &#xe788;</i>
									<a href="{:U('Me/point')}">我的积分</a>
									<i class="iconfont">&#xe607;</i>
								</li>
								<li style="border-bottom: none;">
								<i class="iconfont">&#xe683;</i>
								<a href="{:U('Me/address')}">收货地址</a>
								<i class="iconfont">&#xe607;</i>
							</li>
							</ul>
						</li>
					</ul>

				</div>
			<!-- /.u-menu -->
			<div class="col-md-9-a bg-white">
				<div class="panel-t">
					<div class="line-g"></div>
					<p>我的账户>绑定银行卡</p>
				</div>
				<hr />
				<div class="padding20">
					<span class="cc-tit"><i class="iconfont">&#xe6e6;</i>你好，为保护您的账户资金安全，只能提现到本人的储蓄卡。</span>
					<div class="margin30">
						<form class="form-horizontal">
							<div class="form-group">
								<label class="col-sm-2 col-sm-offset-2 control-label">姓名：</label>
								<div class="col-sm-4">
									<input type="text" name="name" class="form-control" p="/^\S{1,20}$/">
									<span class="ck-name prompt">正确</span>
								</div>
							</div>
							<div class="form-group">
								<label class="col-sm-2 col-sm-offset-2 control-label">身份证号：</label>
								<div class="col-sm-4">
									<input type="text" class="form-control" name="id-card" onkeyup="isCardID(this)" maxlength="18" />
									<span class="ck-id prompt">正确</span>
								</div>
							</div>
							<div class="form-group">
								<label class="col-sm-2 col-sm-offset-2 control-label">银行卡号：</label>
								<div class="col-sm-4">
									<input type="text" class="form-control" name="bank-card" onkeyup="(this.v=function(){this.value=this.value.replace(/[^0-9-]+/,'');}).call(this)" maxlength="19"  />
									<span class="ck-idcard prompt">正确</span>
								</div>
							</div>
							<div class="form-group">
								<label class="col-sm-2 col-sm-offset-2 control-label">所属银行：</label>
								<div class="col-sm-4">
									<input type="text" class="form-control" name="bank" value="">
								</div>
							</div>

							<div class="form-group">
								<label class="col-sm-2 col-sm-offset-2 control-label">所选城市：</label>
								<div class="col-sm-3">
									<input type="text" id="txtprovince" class="d-n" />
									<select id="province" name="province" class="std_se_01" onchange="cityName(this.selectedIndex);"></select>
								</div>
								<div class="col-sm-3">
									<input type="text" id="txtcity" class="d-n" />
									<select id="city" name="city" class="std_se_01" onchange="citychange(this.value);"></select>
								</div>
							</div>
							<div class="form-group">
								<label class="col-sm-2 col-sm-offset-2 control-label">预留手机号：</label>
								<div class="col-sm-4">
									<input type="text" class="form-control" name="tel" onkeyup="(this.v=function(){this.value=this.value.replace(/[^0-9-]+/,'');}).call(this)" maxlength="11" p="/^(((13|14|15|18|17|19)\d{9}))$/">
									<span class="ck-tel prompt">正确</span>
								</div>
							</div>
							<div class="form-group">
								<label class="col-sm-2 col-sm-offset-2 control-label">手机验证码：</label>
								<div class="col-sm-2">
									<input type="text" class="form-control" id="huiverify"/>
									<span class="ck-yzm prompt">正确</span>
								</div>
								<div class="col-sm-2">
									<input id="btnSendCode" type="button" value="获取验证码"/>
								</div>
							</div>
							<div class="form-group" style="text-align: center;">

								<button type="button" class="btn btn-47c margin_t30" id="ding">　提交　</button>
							</div>

						</form>
					</div>
				</div>

			</div>
		</div>

		<!-- 返回顶部开始 -->
		<div>
			<div id="moquu_wxin" class="moquu_wxin"><a href="javascript:void(0)">1<div class="moquu_wxinh"></div></a></div>
			<div id="moquu_wshare" class="moquu_wshare"><a href="javascript:void(0)">2<div class="moquu_wshareh"></div></a></div>
			<a id="moquu_top" href="javascript:void(0)"></a>
		</div>
		<!-- 返回顶部结束 -->

		<!--页脚开始-->
		<include file="Public/jiaoyazi" />
		<!--页脚结束-->

		<script src="__PUBLIC__/Home/saibangzi/js/jquery-2.1.0.js"></script>
		<script src="__PUBLIC__/Home/saibangzi/js/index.js"></script>
		<script src="__PUBLIC__/Home/saibangzi/js/per-data/check-card.js"></script>
		<script src="__PUBLIC__/Home/saibangzi/plugins/csld/js/diqu.js"></script>
		<script src="__PUBLIC__/Home/saibangzi/plugins/csld/js/LocalStore.js"></script>
		<script src="__PUBLIC__/Home/saibangzi/js/forget-password.js"></script>
		<script>
			var a=$('#sex').val();
			if(a=='男'){
				$('#sexicon').html('&#xe76d;');
			}else{
				$('#sexicon').html('&#xe62d;');
			}
			function sign(){
				$.ajax({
					type:'post',
					url:"{:U('Me/sign')}",
					success:function(date){
						if(date=='200'){
							alert('签到成功');
							window.location.href="javascript:location.replace(location.href);"	
						}else if(date=='202'){
							alert('网络异常');
						}else{
							alert('今日已签到');
						}
					},
					error:function(err){
						alert('网络异常');
					}
				});
			}
			$('#ding').click(function(){
				var  name=$('[name=name]').val();
				var  card=$('[name=id-card]').val();
				var  bankcard=$('[name=bank-card]').val();
				var  bank=$('[name=bank]').val();
				var  province=$('[name=province]').val();
				var  city=$('[name=city]').val();
				var  tel=$('[name=tel]').val();
				var verify=$('#huiverify').val();
				if(bank=='没有查到该卡号'){
					return false;
				}
				if(bank=='该卡号不是借记卡'){
					return false;
				}
				$.post("{:U('Me/addbank')}", {'phone':tel,'name':name,'verify':verify,'idcard':card,'bankcard':bankcard,'bank':bank,'city':city,'province':province},function(data){
			        if(data=='添加成功'){
			        	alert(data)
			       	  window.location.href="{:U('Me/index')}";
			       }else{
			       	 alert(data);
			     	 window.location.href="{:U('Me/index')}";
			        }
			      });
			})
			$('#btnSendCode').click(function(){
			      var tel = $('[name=tel]').val();
			     // alert(tel);
			      $.post('{:U('Verify/verify')}', {'phone':tel},function(data){
			       //alert(data);
			      
			        if(data=='发送成功'){
			        	 sendMessage();
			       	alert('发送成功');
			       }else{
			     	 alert(data);
			        }
			      });
			    });
			$('#outlogin').click(function(){
						var a=$('#session').val();
						$.post('{:U('Login/outlogin')}',{'session':a},function(data){
							if(data=='退出成功'){
							alert('退出登录！');window.location.href="{:U('index/index')}";}
						})
						
					});
			$('[name=bank-card]').blur(function(){
				var v=$('[name=bank-card]').val();
				$.post('{:U('bcard')}',{'card':v},function(data){
					
					if(data=='没有查到该卡号' || data=='该卡号不是借记卡'){
						$('[name=bank]').val(data);
					}else{prompt
						$('[name=bank]').val(data);
					}
				})
			})


			function isCardID(e){
				if($(e).val().length <18){
					$(e).val($(e).val().replace(/[^0-9-]+/,''));
				}else{
					if(!/^\d{17}(\d|x)$/i.test($(e).val())){
						$(e).val($(e).val().substring(0,17));
					}
				}
			}

			$("input[name='id-card']").blur(function () {
				if($(this).val().length < 18){
					$(this).css("border-color","red");
					$(this).next().show().css("color","red").html("格式错误");
				}else{
					$(this).css("border-color","green");
					$(this).next().show().css("color","green").html("格式正确");
				}
			});

			$("input[name='bank-card']").blur(function () {
				if($(this).val().length < 9){
					$(this).css("border-color","red");
					$(this).next().show().css("color","red").html("格式错误");
				}else{
					$(this).css("border-color","green");
					$(this).next().show().css("color","green").html("格式正确");
				}
			});bank-card

		</script>
	</body>

</html>